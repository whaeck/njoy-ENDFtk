import unittest

# local imports
from ENDFtk.MF16 import GSection

class Test_ENDFtk_MF16_Section( unittest.TestCase ) :
    """
    Unit test for the GSection class of MF16
    """

    chunk_inelastic = ( " 9.223500+4 0.000000+0          1          1          0         20922816 52     \n"
    " 2.936000+2 0.000000+0          2          1          2          7922816 52     \n"
    " 1.696074+6 1.311037-7                                            922816 52     \n"
    " 2.936000+2 0.000000+0          2          1          2          8922816 52     \n"
    " 1.370348+6 9.841964-6                                            922816 52     \n"
    " 2.936000+2 0.000000+0          2          1          2          9922816 52     \n"
    " 3.611499+5 2.343987-5                                            922816 52     \n"
    " 2.936000+2 0.000000+0          2          1          2         10922816 52     \n"
    " 1.010491+6 3.888503-5                                            922816 52     \n"
    " 2.936000+2 0.000000+0          2          1          2         11922816 52     \n"
    " 7.295986+5 5.173100-5                                            922816 52     \n"
    " 2.936000+2 0.000000+0          2          1          2         12922816 52     \n"
    " 1.693616+6 5.123670-5                                            922816 52     \n"
    " 2.936000+2 0.000000+0          2          1          2         13922816 52     \n"
    " 5.107883+5 3.520423-5                                            922816 52     \n"
    " 2.936000+2 0.000000+0          2          1          2         14922816 52     \n"
    " 1.014623+6 1.955523-5                                            922816 52     \n"
    " 2.936000+2 0.000000+0          2          1          2         15922816 52     \n"
    " 8.255313+5 4.939553-6                                            922816 52     \n"
    " 2.936000+2 0.000000+0          2          1          2         16922816 52     \n"
    " 6.500049+5 3.492097-7                                            922816 52     \n"
    " 2.936000+2 0.000000+0          2          1          2         17922816 52     \n"
    " 3.338837+4 2.71668-11                                            922816 52     \n"
    " 2.936000+2 0.000000+0          2          1          2         20922816 52     \n"
    " 9.073605+2 0.000000+0                                            922816 52     \n" )

    chunk_fission = ( " 9.223500+4 0.000000+0          1          1          0         20922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13          1922816 18     \n"
    " 1.611884+4 1.460238+3 1.289345+4 8.446402+3 6.376999+3 2.030839+3922816 18     \n"
    " 6.685875+2 2.080737+2 6.171073+1 1.760082+1 4.767598+0 1.270951+0922816 18     \n"
    " 5.256335-1                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13          2922816 18     \n"
    " 1.110213+7 2.174016+2 1.919589+3 1.257508+3 9.494134+2 3.023532+2922816 18     \n"
    " 9.953992+1 3.097821+1 9.187550+0 2.620427+0 7.098044-1 1.892203-1922816 18     \n"
    " 7.825679-2                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13          3922816 18     \n"
    " 2.451436+6 8.789085+1 7.760492+2 5.083839+2 3.838277+2 1.222350+2922816 18     \n"
    " 4.024188+1 1.252383+1 3.714332+0 1.059383+0 2.869589-1 7.649776-2922816 18     \n"
    " 3.163756-2                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13          4922816 18     \n"
    " 3.461286+6 1.894271+1 1.672583+2 1.095696+2 8.272460+1 2.634474+1922816 18     \n"
    " 8.673145+0 2.699203+0 8.005326-1 2.283239-1 6.184691-2 1.648720-2922816 18     \n"
    " 6.818696-3                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13          5922816 18     \n"
    " 3.753318+6 1.648537+1 1.455608+2 9.535576+1 7.199320+1 2.292718+1922816 18     \n"
    " 7.548026+0 2.349051+0 6.966840-1 1.987047-1 5.382386-2 1.434841-2922816 18     \n"
    " 5.934145-3                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13          6922816 18     \n"
    " 3.571209+6 4.401633+0 3.886507+1 2.546021+1 1.922235+1 6.121612+0922816 18     \n"
    " 2.015341+0 6.272020-1 1.860163-1 5.305462-2 1.437109-2 3.831059-3922816 18     \n"
    " 1.584431-3                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13          7922816 18     \n"
    " 1.696074+6 1.318711+0 1.164381+1 7.627771+0 5.758935+0 1.834009+0922816 18     \n"
    " 6.037875-1 1.879071-1 5.572968-2 1.589494-2 4.305519-3 1.147769-3922816 18     \n"
    " 4.746887-4                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13          8922816 18     \n"
    " 1.370348+6 8.168205-1 7.212274+0 4.724705+0 3.567133+0 1.136001+0922816 18     \n"
    " 3.739911-1 1.163912-1 3.451943-2 9.845459-3 2.666875-3 7.109379-4922816 18     \n"
    " 2.940262-4                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13          9922816 18     \n"
    " 3.611499+5 7.021668-1 6.199916+0 4.061518+0 3.066429+0 9.765448-1922816 18     \n"
    " 3.214955-1 1.000539-1 2.967408-2 8.463492-3 2.292537-3 6.111464-4922816 18     \n"
    " 2.527549-4                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13         10922816 18     \n"
    " 1.010491+6 6.043935-1 5.336608+0 3.495971+0 2.639444+0 8.405657-1922816 18     \n"
    " 2.767288-1 8.612185-2 2.554211-2 7.284992-3 1.973312-3 5.260473-4922816 18     \n"
    " 2.175600-4                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13         11922816 18     \n"
    " 7.295986+5 5.187680-1 4.580562+0 3.000691+0 2.265509+0 7.214813-1922816 18     \n"
    " 2.375242-1 7.392082-2 2.192352-2 6.252915-3 1.693750-3 4.515213-4922816 18     \n"
    " 1.867379-4                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13         12922816 18     \n"
    " 1.693616+6 4.710067-1 4.158844+0 2.724427+0 2.056931+0 6.550568-1922816 18     \n"
    " 2.156561-1 6.711516-2 1.990509-2 5.677229-3 1.537811-3 4.099511-4922816 18     \n"
    " 1.695456-4                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13         13922816 18     \n"
    " 5.107883+5 4.911859-1 4.337020+0 2.841149+0 2.145055+0 6.831212-1922816 18     \n"
    " 2.248953-1 6.999055-2 2.075787-2 5.920456-3 1.603695-3 4.275145-4922816 18     \n"
    " 1.768093-4                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13         14922816 18     \n"
    " 1.014623+6 5.186212-1 4.579265+0 2.999842+0 2.264868+0 7.212771-1922816 18     \n"
    " 2.374569-1 7.389989-2 2.191731-2 6.251145-3 1.693270-3 4.513935-4922816 18     \n"
    " 1.866851-4                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13         15922816 18     \n"
    " 8.255313+5 5.472796-1 4.832310+0 3.165610+0 2.390022+0 7.611341-1922816 18     \n"
    " 2.505785-1 7.798352-2 2.312844-2 6.596576-3 1.786838-3 4.763370-4922816 18     \n"
    " 1.970011-4                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13         16922816 18     \n"
    " 6.500049+5 5.572574-1 4.920411+0 3.223324+0 2.433596+0 7.750108-1922816 18     \n"
    " 2.551470-1 7.940528-2 2.355011-2 6.716842-3 1.819415-3 4.850214-4922816 18     \n"
    " 2.005927-4                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13         17922816 18     \n"
    " 3.338837+4 8.910025-1 7.867278+0 5.153793+0 3.891093+0 1.239170+0922816 18     \n"
    " 4.079562-1 1.269616-1 3.765442-2 1.073960-2 2.909075-3 7.755038-4922816 18     \n"
    " 3.207290-4                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13         18922816 18     \n"
    " 1.067061+5 1.091430+0 9.636988+0 6.313117+0 4.766377+0 1.517916+0922816 18     \n"
    " 4.997241-1 1.555211-1 4.612462-2 1.315543-2 3.563459-3 9.499500-4922816 18     \n"
    " 3.928756-4                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13         19922816 18     \n"
    " 2.467532+3 1.210152+0 1.068527+1 6.999837+0 5.284848+0 1.683030+0922816 18     \n"
    " 5.540825-1 1.724382-1 5.114190-2 1.458644-2 3.951080-3 1.053282-3922816 18     \n"
    " 4.356114-4                                                       922816 18     \n"
    " 2.936000+2 0.000000+0         13          1         13         20922816 18     \n"
    " 9.073605+2 1.200252+0 1.059786+1 6.942574+0 5.241615+0 1.669261+0922816 18     \n"
    " 5.495498-1 1.710275-1 5.072353-2 1.446711-2 3.918758-3 1.044666-3922816 18     \n"
    " 4.320478-4                                                       922816 18     \n" )

    validSEND = ( "                                                                  922816  0     \n" )

    def test_section( self ) :

        def verify_chunk_inelastic( self, chunk ) :
            self.assertEqual( 52, chunk.MT )
            self.assertEqual( 52, chunk.section_number )
            self.assertEqual( 92235, chunk.ZA )
            self.assertEqual( 92235, chunk.target_identifier )
            self.assertEqual( 1, chunk.NZ )
            self.assertEqual( 1, chunk.number_dilutions )
            self.assertEqual( 1, chunk.NL )
            self.assertEqual( 1, chunk.number_moments )
            self.assertEqual( 20, chunk.NGN )
            self.assertEqual( 20, chunk.number_groups )
            self.assertAlmostEqual( 0.0, chunk.AWR )
            self.assertAlmostEqual( 0.0, chunk.atomic_weight_ratio )
            self.assertAlmostEqual( 293.6, chunk.TEMP )
            self.assertAlmostEqual( 293.6, chunk.temperature )
            expected_groups = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]

            expected_flux = [[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.696074e+6, 1.370348e+6, 3.611499e+5, 1.010491e+6, 7.295986e+5, 1.693616e+6, 5.107883e+5, 1.014623e+6,
              8.255313e+5, 6.500049e+5, 3.338837e+4, 0.0, 0.0, 9.073605e+2]]]
            expected_matrix = [
                [
                    [
                        [ 0.0, 0.0 ],
                        [ 0.0, 0.0 ],
                        [ 0.0, 0.0 ],
                        [ 0.0, 0.0 ],
                        [ 0.0, 0.0 ],
                        [ 0.0, 0.0 ],
                        [ 1.311037e-7, 0.0 ],
                        [ 9.841964e-6, 0.0 ],
                        [ 2.343987e-5, 0.0 ],
                        [ 3.888503e-5, 0.0 ],
                        [ 5.173100e-5, 0.0 ],
                        [ 5.123670e-5, 0.0 ],
                        [ 3.520423e-5, 0.0 ],
                        [ 1.955523e-5, 0.0 ],
                        [ 4.939553e-6, 0.0 ],
                        [ 3.492097e-7, 0.0 ],
                        [ 2.71668e-11, 0.0 ],
                        [ 0.0, 0.0 ],
                        [ 0.0, 0.0 ],
                        [ 0.0, 0.0 ]

                    ]
                ]
            ]

            for g_i in range( chunk.NGN ) :
                self.assertAlmostEqual( expected_groups[g_i], chunk.groups[g_i])
                self.assertAlmostEqual( expected_flux[0][0][g_i], chunk.flux( 0, 0 )[g_i])
                for g_o in range( 2 ):
                    self.assertAlmostEqual( expected_matrix[0][0][g_i][g_o], chunk.matrix( 0, 0 )[g_i][g_o] )

            # verify string
            self.assertEqual( self.chunk_inelastic + self.validSEND, chunk.to_string( 9228, 16 ) )

        def verify_chunk_fission( self, chunk ) :
            self.assertEqual( 18, chunk.MT )
            self.assertEqual( 18, chunk.section_number )
            self.assertEqual( 92235, chunk.ZA )
            self.assertEqual( 92235, chunk.target_identifier )
            self.assertEqual( 1, chunk.NZ )
            self.assertEqual( 1, chunk.number_dilutions )
            self.assertEqual( 1, chunk.NL )
            self.assertEqual( 1, chunk.number_moments )
            self.assertEqual( 20, chunk.NGN )
            self.assertEqual( 20, chunk.number_groups )
            self.assertAlmostEqual( 0.0, chunk.AWR )
            self.assertAlmostEqual( 0.0, chunk.atomic_weight_ratio )
            self.assertAlmostEqual( 293.6, chunk.TEMP )
            self.assertAlmostEqual( 293.6, chunk.temperature )
            expected_groups = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]

            expected_flux = [[[ 1.611884e+4, 1.110213e+7, 2.451436e+6, 3.461286e+6, 3.753318e+6, 3.571209e+6, 1.696074e+6, 1.370348e+6, 3.611499e+5, 1.010491e+6,
                      7.295986e+5, 1.693616e+6, 5.107883e+5, 1.014623e+6, 8.255313e+5, 6.500049e+5, 3.338837e+4, 1.067061e+5, 2.467532e+3, 9.073605e+2 ]]]

            expected_matrix = [
                [
                    [
                        [ 1.460238e+3, 1.289345e+4, 8.446402e+3, 6.376999e+3, 2.030839e+3, 6.685875e+2, 2.080737e+2, 6.171073e+1, 1.760082e+1, 4.767598, 1.270951, 5.256335e-1 ],
                        [ 2.174016e+2, 1.919589e+3, 1.257508e+3, 9.494134e+2, 3.023532e+2, 9.953992e+1, 3.097821e+1, 9.187550, 2.620427, 7.098044e-1, 1.892203e-1, 7.825679e-2 ],
                        [ 8.789085e+1, 7.760492e+2, 5.083839e+2, 3.838277e+2, 1.222350e+2, 4.024188e+1, 1.252383e+1, 3.714332, 1.059383, 2.869589e-1, 7.649776e-2, 3.163756e-2 ],
                        [ 1.894271e+1, 1.672583e+2, 1.095696e+2, 8.272460e+1, 2.634474e+1, 8.673145, 2.699203, 8.005326e-1, 2.283239e-1, 6.184691e-2, 1.648720e-2, 6.818696e-3 ],
                        [ 1.648537e+1, 1.455608e+2, 9.535576e+1, 7.199320e+1, 2.292718e+1, 7.548026, 2.349051, 6.966840e-1, 1.987047e-1, 5.382386e-2, 1.434841e-2, 5.934145e-3 ],
                        [ 4.401633, 3.886507e+1, 2.546021e+1, 1.922235e+1, 6.121612, 2.015341, 6.272020e-1, 1.860163e-1, 5.305462e-2, 1.437109e-2, 3.831059e-3, 1.584431e-3 ],
                        [ 1.318711, 1.164381e+1, 7.627771, 5.758935, 1.834009, 6.037875e-1, 1.879071e-1, 5.572968e-2, 1.589494e-2, 4.305519e-3, 1.147769e-3, 4.746887e-4 ],
                        [ 8.168205e-1, 7.212274, 4.724705, 3.567133, 1.136001, 3.739911e-1, 1.163912e-1, 3.451943e-2, 9.845459e-3, 2.666875e-3, 7.109379e-4, 2.940262e-4 ],
                        [ 7.021668e-1, 6.199916, 4.061518, 3.066429, 9.765448e-1, 3.214955e-1, 1.000539e-1, 2.967408e-2, 8.463492e-3, 2.292537e-3, 6.111464e-4, 2.527549e-4 ],
                        [ 6.043935e-1, 5.336608, 3.495971, 2.639444, 8.405657e-1, 2.767288e-1, 8.612185e-2, 2.554211e-2, 7.284992e-3, 1.973312e-3, 5.260473e-4, 2.175600e-4 ],
                        [ 5.187680e-1, 4.580562, 3.000691, 2.265509, 7.214813e-1, 2.375242e-1, 7.392082e-2, 2.192352e-2, 6.252915e-3, 1.693750e-3, 4.515213e-4, 1.867379e-4 ],
                        [ 4.710067e-1, 4.158844, 2.724427, 2.056931, 6.550568e-1, 2.156561e-1, 6.711516e-2, 1.990509e-2, 5.677229e-3, 1.537811e-3, 4.099511e-4, 1.695456e-4 ],
                        [ 4.911859e-1, 4.337020, 2.841149, 2.145055, 6.831212e-1, 2.248953e-1, 6.999055e-2, 2.075787e-2, 5.920456e-3, 1.603695e-3, 4.275145e-4, 1.768093e-4 ],
                        [ 5.186212e-1, 4.579265, 2.999842, 2.264868, 7.212771e-1, 2.374569e-1, 7.389989e-2, 2.191731e-2, 6.251145e-3, 1.693270e-3, 4.513935e-4, 1.866851e-4 ],
                        [ 5.472796e-1, 4.832310, 3.165610, 2.390022, 7.611341e-1, 2.505785e-1, 7.798352e-2, 2.312844e-2, 6.596576e-3, 1.786838e-3, 4.763370e-4, 1.970011e-4 ],
                        [ 5.572574e-1, 4.920411, 3.223324, 2.433596, 7.750108e-1, 2.551470e-1, 7.940528e-2, 2.355011e-2, 6.716842e-3, 1.819415e-3, 4.850214e-4, 2.005927e-4 ],
                        [ 8.910025e-1, 7.867278, 5.153793, 3.891093, 1.239170, 4.079562e-1, 1.269616e-1, 3.765442e-2, 1.073960e-2, 2.909075e-3, 7.755038e-4, 3.207290e-4 ],
                        [ 1.091430, 9.636988, 6.313117, 4.766377, 1.517916, 4.997241e-1, 1.555211e-1, 4.612462e-2, 1.315543e-2, 3.563459e-3, 9.499500e-4, 3.928756e-4 ],
                        [ 1.210152, 1.068527e+1, 6.999837, 5.284848, 1.683030, 5.540825e-1, 1.724382e-1, 5.114190e-2, 1.458644e-2, 3.951080e-3, 1.053282e-3, 4.356114e-4 ],
                        [ 1.200252, 1.059786e+1, 6.942574, 5.241615, 1.669261, 5.495498e-1, 1.710275e-1, 5.072353e-2, 1.446711e-2, 3.918758e-3, 1.044666e-3, 4.320478e-4 ]
                    ]
                ]
            ]

            for g_i in range( chunk.NGN ) :
                self.assertAlmostEqual( expected_groups[g_i], chunk.groups[g_i])
                self.assertAlmostEqual( expected_flux[0][0][g_i], chunk.flux( 0, 0 )[g_i])
                for g_o in range( 12 ):
                    self.assertAlmostEqual( expected_matrix[0][0][g_i][g_o], chunk.matrix( 0, 0 )[g_i][g_o] )

            # verify string
            self.assertEqual( self.chunk_fission + self.validSEND, chunk.to_string( 9228, 16 ) )

        # TESTS

        # When the data is provided explicitly for inelastic scattering
        groups = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
        flux = [
            [
                [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.696074e+6, 1.370348e+6, 3.611499e+5, 1.010491e+6, 7.295986e+5, 1.693616e+6, 5.107883e+5, 1.014623e+6,
              8.255313e+5, 6.500049e+5, 3.338837e+4, 0.0, 0.0, 9.073605e+2]
            ]
        ]
        matrix = [
                [
                    [
                        [ 0.0, 0.0 ],
                        [ 0.0, 0.0 ],
                        [ 0.0, 0.0 ],
                        [ 0.0, 0.0 ],
                        [ 0.0, 0.0 ],
                        [ 0.0, 0.0 ],
                        [ 1.311037e-7, 0.0 ],
                        [ 9.841964e-6, 0.0 ],
                        [ 2.343987e-5, 0.0 ],
                        [ 3.888503e-5, 0.0 ],
                        [ 5.173100e-5, 0.0 ],
                        [ 5.123670e-5, 0.0 ],
                        [ 3.520423e-5, 0.0 ],
                        [ 1.955523e-5, 0.0 ],
                        [ 4.939553e-6, 0.0 ],
                        [ 3.492097e-7, 0.0 ],
                        [ 2.71668e-11, 0.0 ],
                        [ 0.0, 0.0 ],
                        [ 0.0, 0.0 ],
                        [ 0.0, 0.0 ]

                    ]
                ]
            ]
        chunk = GSection( mt = 52, zaid = 92235, awr = 0.0,
                          lr = 0, ngn = 20, temp = 293.6,
                          groups = groups, flux = flux,
                          matrix = matrix )

        # then it can be verified
        verify_chunk_inelastic( self, chunk )


        # when the data is read from a string/buffer
        chunk = GSection.from_string( self.chunk_inelastic + self.validSEND )

        # then it can be verified
        verify_chunk_inelastic( self, chunk )

        # When the data for a fission section is provided explicitly
        groups = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
        flux = [
            [
                [ 1.611884e+4, 1.110213e+7, 2.451436e+6, 3.461286e+6, 3.753318e+6, 3.571209e+6, 1.696074e+6, 1.370348e+6, 3.611499e+5, 1.010491e+6,
                7.295986e+5, 1.693616e+6, 5.107883e+5, 1.014623e+6, 8.255313e+5, 6.500049e+5, 3.338837e+4, 1.067061e+5, 2.467532e+3, 9.073605e+2 ]
            ]
        ]
        matrix = [
                [
                    [
                        [ 1.460238e+3, 1.289345e+4, 8.446402e+3, 6.376999e+3, 2.030839e+3, 6.685875e+2, 2.080737e+2, 6.171073e+1, 1.760082e+1, 4.767598, 1.270951, 5.256335e-1 ],
                        [ 2.174016e+2, 1.919589e+3, 1.257508e+3, 9.494134e+2, 3.023532e+2, 9.953992e+1, 3.097821e+1, 9.187550, 2.620427, 7.098044e-1, 1.892203e-1, 7.825679e-2 ],
                        [ 8.789085e+1, 7.760492e+2, 5.083839e+2, 3.838277e+2, 1.222350e+2, 4.024188e+1, 1.252383e+1, 3.714332, 1.059383, 2.869589e-1, 7.649776e-2, 3.163756e-2 ],
                        [ 1.894271e+1, 1.672583e+2, 1.095696e+2, 8.272460e+1, 2.634474e+1, 8.673145, 2.699203, 8.005326e-1, 2.283239e-1, 6.184691e-2, 1.648720e-2, 6.818696e-3 ],
                        [ 1.648537e+1, 1.455608e+2, 9.535576e+1, 7.199320e+1, 2.292718e+1, 7.548026, 2.349051, 6.966840e-1, 1.987047e-1, 5.382386e-2, 1.434841e-2, 5.934145e-3 ],
                        [ 4.401633, 3.886507e+1, 2.546021e+1, 1.922235e+1, 6.121612, 2.015341, 6.272020e-1, 1.860163e-1, 5.305462e-2, 1.437109e-2, 3.831059e-3, 1.584431e-3 ],
                        [ 1.318711, 1.164381e+1, 7.627771, 5.758935, 1.834009, 6.037875e-1, 1.879071e-1, 5.572968e-2, 1.589494e-2, 4.305519e-3, 1.147769e-3, 4.746887e-4 ],
                        [ 8.168205e-1, 7.212274, 4.724705, 3.567133, 1.136001, 3.739911e-1, 1.163912e-1, 3.451943e-2, 9.845459e-3, 2.666875e-3, 7.109379e-4, 2.940262e-4 ],
                        [ 7.021668e-1, 6.199916, 4.061518, 3.066429, 9.765448e-1, 3.214955e-1, 1.000539e-1, 2.967408e-2, 8.463492e-3, 2.292537e-3, 6.111464e-4, 2.527549e-4 ],
                        [ 6.043935e-1, 5.336608, 3.495971, 2.639444, 8.405657e-1, 2.767288e-1, 8.612185e-2, 2.554211e-2, 7.284992e-3, 1.973312e-3, 5.260473e-4, 2.175600e-4 ],
                        [ 5.187680e-1, 4.580562, 3.000691, 2.265509, 7.214813e-1, 2.375242e-1, 7.392082e-2, 2.192352e-2, 6.252915e-3, 1.693750e-3, 4.515213e-4, 1.867379e-4 ],
                        [ 4.710067e-1, 4.158844, 2.724427, 2.056931, 6.550568e-1, 2.156561e-1, 6.711516e-2, 1.990509e-2, 5.677229e-3, 1.537811e-3, 4.099511e-4, 1.695456e-4 ],
                        [ 4.911859e-1, 4.337020, 2.841149, 2.145055, 6.831212e-1, 2.248953e-1, 6.999055e-2, 2.075787e-2, 5.920456e-3, 1.603695e-3, 4.275145e-4, 1.768093e-4 ],
                        [ 5.186212e-1, 4.579265, 2.999842, 2.264868, 7.212771e-1, 2.374569e-1, 7.389989e-2, 2.191731e-2, 6.251145e-3, 1.693270e-3, 4.513935e-4, 1.866851e-4 ],
                        [ 5.472796e-1, 4.832310, 3.165610, 2.390022, 7.611341e-1, 2.505785e-1, 7.798352e-2, 2.312844e-2, 6.596576e-3, 1.786838e-3, 4.763370e-4, 1.970011e-4 ],
                        [ 5.572574e-1, 4.920411, 3.223324, 2.433596, 7.750108e-1, 2.551470e-1, 7.940528e-2, 2.355011e-2, 6.716842e-3, 1.819415e-3, 4.850214e-4, 2.005927e-4 ],
                        [ 8.910025e-1, 7.867278, 5.153793, 3.891093, 1.239170, 4.079562e-1, 1.269616e-1, 3.765442e-2, 1.073960e-2, 2.909075e-3, 7.755038e-4, 3.207290e-4 ],
                        [ 1.091430, 9.636988, 6.313117, 4.766377, 1.517916, 4.997241e-1, 1.555211e-1, 4.612462e-2, 1.315543e-2, 3.563459e-3, 9.499500e-4, 3.928756e-4 ],
                        [ 1.210152, 1.068527e+1, 6.999837, 5.284848, 1.683030, 5.540825e-1, 1.724382e-1, 5.114190e-2, 1.458644e-2, 3.951080e-3, 1.053282e-3, 4.356114e-4 ],
                        [ 1.200252, 1.059786e+1, 6.942574, 5.241615, 1.669261, 5.495498e-1, 1.710275e-1, 5.072353e-2, 1.446711e-2, 3.918758e-3, 1.044666e-3, 4.320478e-4 ]
                    ]
                ]
            ]

        chunk = GSection( mt = 18, zaid = 92235, awr = 0.0,
                          lr = 0, ngn = 20, temp = 293.6,
                          groups = groups, flux = flux,
                          matrix = matrix )

        # then it can be verified
        verify_chunk_fission( self, chunk )

        # when it is read from a string/buffer
        chunk = GSection.from_string( self.chunk_fission + self.validSEND )

        # then it can be verified
        verify_chunk_fission( self, chunk )