// include Catch2
#include <catch2/catch_test_macros.hpp>
#include <catch2/matchers/catch_matchers_floating_point.hpp>
using Catch::Matchers::WithinRel;

// what is being tested
#include "ENDFtk/gsection/6g.hpp"

// other includes
#include "ENDFtk/tree/Section.hpp"
#include "tools/std20/algorithm.hpp"

// aliasing
using namespace njoy::ENDFtk;

std::string chunk();
std::string validSEND();
// Note: MF6 MT18, the prob here are definitely chi

void verifyChunk( const section::GType< 6 >& );

SCENARIO("section::GType<6>") {

    GIVEN("valid data for a section::GType<3> with matrix values") {
        std::string sectionString = chunk() + validSEND();

        WHEN("the data is read from a string") {

            std::string line = chunk() + validSEND();
            auto begin = line.begin();
            auto end = line.end();
            long lineNumber = 0;
            auto head = HeadRecord(begin, end, lineNumber);

            section::GType< 6 > chunk(head, begin, end, lineNumber, 9228 );


            THEN("a section GType< 6 > can be constructed and its"
                " members can be tested") {
                verifyChunk(chunk);
            } // THEN

            THEN("it can be printed") {

            }

        } // WHEN

    } // GIVEN

} // SCENARIO

std::string chunk() {
    return
    " 9.223500+4 0.000000+0          6          3          0         309228 6  2     \n"
    " 2.936000+2 0.000000+0          2          1         36          19228 6  2     \n"
    " 1.270791+7 1.270790+7 1.270790+7 1.270790+7 1.270790+7 1.270790+79228 6  2     \n"
    " 1.197023+7 1.128546+7 1.064863+7 1.005541+7 9.502012+6 8.985072+69228 6  2     \n"
    " 2.016090+6 3.552522+5 6.788326+4 1.382838+4 2.964397+3 6.620160+29228 6  2     \n"
    " 1.402599+1 4.116490-2 5.610399-5 0.000000+0 0.000000+0 0.000000+09228 6  2     \n"
    " 1.402210+1 4.114286-2 5.606033-5 0.000000+0 0.000000+0 0.000000+09228 6  2     \n"
    " 1.398153+1 4.092680-2 5.565364-5 0.000000+0 0.000000+0 0.000000+09228 6  2     \n"
    " 2.936000+2 0.000000+0          3          1         54          29228 6  2     \n"
    " 1.149905+6 1.149905+6 1.149905+6 1.149905+6 1.149905+6 1.149905+69228 6  2     \n"
    " 1.124479+6 1.099624+6 1.075328+6 1.051578+6 1.028361+6 1.005665+69228 6  2     \n"
    " 3.559089+5 1.113871+5 3.530483+4 1.135028+4 3.706442+3 1.230753+39228 6  2     \n"
    " 1.159120-1-3.840804-2-1.374497-4-3.257381-7-8.961528-8-1.619834-79228 6  2     \n"
    " 1.156551-1-3.824017-2-1.343424-4-2.880940-7-7.551754-8-1.604192-79228 6  2     \n"
    " 1.073600-1-3.264860-2-5.553544-5 3.713596-7 1.393356-7-9.384019-89228 6  2     \n"
    " 1.338970+1 7.804564-2 1.914806-4 3.263548-7 8.298320-8 1.575368-79228 6  2     \n"
    " 1.338992+1 7.787763-2 1.883729-4 2.887025-7 6.895759-8 1.560306-79228 6  2     \n"
    " 1.339702+1 7.227781-2 1.095446-4-3.709932-7-1.433481-7 9.151439-89228 6  2     \n"
    " 2.936000+2 0.000000+0          3          2         54          39228 6  2     \n"
    " 1.158584+6 1.158584+6 1.158583+6 1.158583+6 1.158583+6 1.158583+69228 6  2     \n"
    " 1.147463+6 1.136454+6 1.125556+6 1.114767+6 1.104086+6 1.093512+69228 6  2     \n"
    " 5.945259+5 3.080750+5 1.610641+5 8.488231+4 4.505542+4 2.406843+49228 6  2     \n"
    " 1.144792-1-3.792949-2-1.378453-4-3.372465-7 2.234010-7-2.113055-79228 6  2     \n"
    " 1.139788-1-3.760349-2-1.315790-4-2.941436-7 2.107004-7-1.961328-79228 6  2     \n"
    " 9.247717-2-2.464956-2 2.790722-5 7.868192-8 8.172896-8-4.339714-89228 6  2     \n"
    " 1.287530+1 7.605389-2 1.898064-4 3.407757-7-2.289094-7 2.121531-79228 6  2     \n"
    " 1.287561+1 7.572680-2 1.835378-4 2.976088-7-2.160912-7 1.969583-79228 6  2     \n"
    " 1.288761+1 6.271751-2 2.393885-5-7.730476-8-8.348949-8 4.360265-89228 6  2     \n"
    " 2.936000+2 0.000000+0          3          3         54          49228 6  2     \n"
    " 1.148732+6 1.148732+6 1.148732+6 1.148732+6 1.148732+6 1.148732+69228 6  2     \n"
    " 1.143887+6 1.139071+6 1.134284+6 1.129525+6 1.124794+6 1.120090+69228 6  2     \n"
    " 8.277563+5 6.075435+5 4.518044+5 3.392107+5 2.565034+5 1.950379+59228 6  2     \n"
    " 1.097813-1-3.643019-2-9.808132-5-2.663393-8 1.260314-8-6.149544-89228 6  2     \n"
    " 1.085738-1-3.563909-2-8.807558-5-1.257291-6 1.186377-8-5.534098-89228 6  2     \n"
    " 5.997192-2-1.074848-2 2.925991-5-4.562248-6 7.338219-8-4.620535-99228 6  2     \n"
    " 1.212760+1 7.234867-2 1.470392-4 2.750689-8-1.549619-8 6.091421-89228 6  2     \n"
    " 1.212823+1 7.155418-2 1.370262-4 1.258123-6-1.460169-8 5.479585-89228 6  2     \n"
    " 1.214615+1 4.650515-2 1.939509-5 4.562307-6-7.350595-8 4.606564-99228 6  2     \n"
    " 2.936000+2 0.000000+0          3          4         54          59228 6  2     \n"
    " 1.155337+6 1.155337+6 1.155337+6 1.155337+6 1.155337+6 1.155337+69228 6  2     \n"
    " 1.149144+6 1.143039+6 1.137019+6 1.131082+6 1.125224+6 1.119445+69228 6  2     \n"
    " 8.242293+5 6.180888+5 4.770019+5 3.749173+5 2.984238+5 2.397460+59228 6  2     \n"
    " 9.740075-2-3.228765-2-1.025362-4-3.862044-6 2.343232-7-3.399433-89228 6  2     \n"
    " 9.732505-2-3.221319-2-1.232763-4-3.489904-6 3.896867-7-4.902276-89228 6  2     \n"
    " 8.450807-2-2.215762-2-7.493088-4-2.441161-5 2.491260-6 1.460864-79228 6  2     \n"
    " 1.091143+1 6.460568-2 1.465765-4 3.861650-6-2.387884-7 3.415993-89228 6  2     \n"
    " 1.090985+1 6.452164-2 1.672973-4 3.489532-6-3.941261-7 4.919067-89228 6  2     \n"
    " 1.087841+1 5.427686-2 7.930268-4 2.441198-5-2.492695-6-1.459876-79228 6  2     \n"
    " 2.936000+2 0.000000+0          3          5         54          69228 6  2     \n"
    " 1.154847+6 1.154847+6 1.154847+6 1.154847+6 1.154847+6 1.154847+69228 6  2     \n"
    " 1.141705+6 1.129072+6 1.116916+6 1.105203+6 1.093905+6 1.082994+69228 6  2     \n"
    " 6.987721+5 4.707030+5 3.333788+5 2.433832+5 1.815108+5 1.375783+59228 6  2     \n"
    " 7.255707-2-2.366750-2-3.211800-4 7.710738-6-3.077618-7 6.675628-99228 6  2     \n"
    " 7.307451-2-2.397713-2-3.490604-4 9.788243-6-4.888225-7 2.548259-89228 6  2     \n"
    " 8.372862-2-2.667734-2-1.872872-3-3.621495-6 6.870336-6-1.858840-79228 6  2     \n"
    " 1.174589+1 5.837895-2 3.684599-4-7.711378-6 3.062027-7-6.776788-99228 6  2     \n"
    " 1.169065+1 5.837742-2 3.957247-4-9.788883-6 4.872160-7-2.558563-89228 6  2     \n"
    " 1.095368+1 5.844991-2 1.915804-3 3.621981-6-6.871705-6 1.858561-79228 6  2     \n"
    " 2.936000+2 0.000000+0          3          6         54          79228 6  2     \n"
    " 1.153966+6 1.153966+6 1.153966+6 1.153966+6 1.153966+6 1.153966+69228 6  2     \n"
    " 1.144432+6 1.135065+6 1.125860+6 1.116811+6 1.107916+6 1.099168+69228 6  2     \n"
    " 7.170965+5 4.826207+5 3.414493+5 2.498999+5 1.874672+5 1.433224+59228 6  2     \n"
    " 7.881343-2-2.588198-2 1.308547-4-3.662351-4 7.328916-5 2.325466-59228 6  2     \n"
    " 7.906601-2-2.589373-2-4.782511-5-3.357120-4 8.868408-5 1.169468-59228 6  2     \n"
    " 8.917293-2-2.370853-2-6.909047-3-1.255687-3 4.180911-4 3.134076-49228 6  2     \n"
    " 1.141526+1 5.968445-2-8.486927-5 3.662355-4-7.329112-5-2.325481-59228 6  2     \n"
    " 1.139907+1 5.960379-2 9.362470-5 3.357125-4-8.868606-5-1.169480-59228 6  2     \n"
    " 1.098360+1 5.563976-2 6.951963-3 1.255692-3-4.180921-4-3.134069-49228 6  2     \n"
    " 2.936000+2 0.000000+0          3          7         54          89228 6  2     \n"
    " 1.154819+6 1.154819+6 1.154819+6 1.154819+6 1.154819+6 1.154819+69228 6  2     \n"
    " 1.149445+6 1.144111+6 1.138819+6 1.133567+6 1.128355+6 1.123182+69228 6  2     \n"
    " 8.250987+5 6.107359+5 4.639797+5 3.594302+5 2.826411+5 2.248946+59228 6  2     \n"
    " 1.023005-1-3.338013-2-4.061872-4-1.278720-5 2.861846-6-5.550928-69228 6  2     \n"
    " 1.025090-1-3.352426-2-4.042071-4-9.170105-6 1.878040-6-5.902005-69228 6  2     \n"
    " 1.133754-1-4.036831-2-6.035438-5 3.620878-4-1.151919-4-4.196600-59228 6  2     \n"
    " 1.117259+1 6.702108-2 4.539470-4 1.278787-5-2.865290-6 5.550478-69228 6  2     \n"
    " 1.116635+1 6.712940-2 4.518909-4 9.170780-6-1.881523-6 5.901549-69228 6  2     \n"
    " 1.090725+1 7.277766-2 1.059072-4-3.620873-4 1.151871-4 4.196537-59228 6  2     \n"
    " 2.936000+2 0.000000+0          3          8         54          99228 6  2     \n"
    " 1.153684+6 1.153684+6 1.153684+6 1.153684+6 1.153684+6 1.153684+69228 6  2     \n"
    " 1.149437+6 1.145215+6 1.141017+6 1.136842+6 1.132691+6 1.128564+69228 6  2     \n"
    " 8.671104+5 6.661531+5 5.204219+5 4.119750+5 3.296205+5 2.660554+59228 6  2     \n"
    " 9.123373-2-3.125920-2 4.595441-4 2.408739-4 5.217162-5-1.934501-49228 6  2     \n"
    " 9.118938-2-3.120287-2 4.697587-4 2.219206-4 2.722944-5-1.984191-49228 6  2     \n"
    " 8.678911-2-2.616666-2 6.372456-4-7.397028-4-9.274647-4-4.329605-49228 6  2     \n"
    " 1.155974+1 6.846273-2-3.956638-4-2.408735-4-5.217486-5 1.934502-49228 6  2     \n"
    " 1.155404+1 6.837158-2-4.059565-4-2.219203-4-2.723266-5 1.984191-49228 6  2     \n"
    " 1.129104+1 6.199190-2-5.759681-4 7.397031-4 9.274630-4 4.329607-49228 6  2     \n"
    " 2.936000+2 0.000000+0          3          9         54         109228 6  2     \n"
    " 1.154784+6 1.154784+6 1.154784+6 1.154784+6 1.154784+6 1.154784+69228 6  2     \n"
    " 1.151641+6 1.148509+6 1.145388+6 1.142276+6 1.139175+6 1.136085+69228 6  2     \n"
    " 9.151104+5 7.306688+5 5.872297+5 4.746612+5 3.856192+5 3.146977+59228 6  2     \n"
    " 9.157941-2-2.847209-2-7.100257-4-2.947588-4-7.342737-5 4.059722-59228 6  2     \n"
    " 9.162435-2-2.850141-2-7.249632-4-2.916533-4-6.805463-5 4.758011-59228 6  2     \n"
    " 9.485347-2-3.057042-2-1.815510-3-1.783731-4 6.668423-4 3.686095-49228 6  2     \n"
    " 1.182668+1 7.367774-2 8.273086-4 2.947609-4 7.342460-5-4.059712-59228 6  2     \n"
    " 1.182468+1 7.369416-2 8.422121-4 2.916554-4 6.805186-5-4.758001-59228 6  2     \n"
    " 1.170173+1 7.505724-2 1.931077-3 1.783763-4-6.668455-4-3.686094-49228 6  2     \n"
    " 2.936000+2 0.000000+0          3         10         54         119228 6  2     \n"
    " 1.152800+6 1.152800+6 1.152800+6 1.152800+6 1.152800+6 1.152800+69228 6  2     \n"
    " 1.150432+6 1.148069+6 1.145712+6 1.143359+6 1.141012+6 1.138670+69228 6  2     \n"
    " 9.572601+5 7.958322+5 6.624212+5 5.519959+5 4.604659+5 3.844976+59228 6  2     \n"
    " 1.051344-1-3.419557-2-4.201552-4-1.057933-4 2.981785-5 1.604389-59228 6  2     \n"
    " 1.051084-1-3.418560-2-4.156921-4-1.047171-4 3.005645-5 1.547661-59228 6  2     \n"
    " 1.030043-1-3.334270-2-1.131446-4-3.473917-5 6.370931-5-5.127299-69228 6  2     \n"
    " 1.221637+1 1.015693-1 7.576992-4 1.072962-4-2.982110-5-1.604400-59228 6  2     \n"
    " 1.221597+1 1.015572-1 7.532465-4 1.062201-4-3.005970-5-1.547672-59228 6  2     \n"
    " 1.218568+1 1.005473-1 4.511821-4 3.624468-5-6.371246-5 5.127089-69228 6  2     \n"
    " 2.936000+2 0.000000+0          3         11         54         129228 6  2     \n"
    " 1.156920+6 1.156920+6 1.156920+6 1.156920+6 1.156920+6 1.156920+69228 6  2     \n"
    " 1.154913+6 1.152910+6 1.150910+6 1.148913+6 1.146920+6 1.144931+69228 6  2     \n"
    " 9.854300+5 8.391668+5 7.146757+5 6.087061+5 5.184944+5 4.416904+59228 6  2     \n"
    " 1.038892-1-3.413673-2-2.931866-4-1.924592-6 1.127033-7-1.262087-79228 6  2     \n"
    " 1.038839-1-3.413276-2-2.962219-4 1.776615-7 7.434832-7-6.161633-79228 6  2     \n"
    " 1.034428-1-3.380721-2-5.415626-4 1.731170-4 5.129856-5-4.093581-59228 6  2     \n"
    " 1.196275+1 1.575021-1 1.687767-3 1.117891-5-1.145921-7 1.256599-79228 6  2     \n"
    " 1.196277+1 1.575028-1 1.690964-3 9.078420-6-7.453729-7 6.156148-79228 6  2     \n"
    " 1.196173+1 1.575510-1 1.949668-3-1.637144-4-5.130052-5 4.093528-59228 6  2     \n"
    " 2.936000+2 0.000000+0          3         12         54         139228 6  2     \n"
    " 1.154341+6 1.154341+6 1.154341+6 1.154341+6 1.154341+6 1.154341+69228 6  2     \n"
    " 1.152599+6 1.150859+6 1.149122+6 1.147388+6 1.145657+6 1.143928+69228 6  2     \n"
    " 1.002600+6 8.706505+5 7.560864+5 6.566141+5 5.702433+5 4.952465+59228 6  2     \n"
    " 1.003733-1-3.246933-2-5.799179-4-9.422289-6-1.915814-8-4.730726-89228 6  2     \n"
    " 1.003600-1-3.246081-2-5.794197-4-9.390248-6-5.989034-8-4.136486-89228 6  2     \n"
    " 9.918749-2-3.172007-2-5.374601-4-6.771014-6-3.327814-6 4.375695-79228 6  2     \n"
    " 1.151432+1 3.072534-1 7.917231-3 8.769658-5 3.676530-7 4.447984-89228 6  2     \n"
    " 1.151439+1 3.072537-1 7.917331-3 8.767495-5 4.084953-7 3.853970-89228 6  2     \n"
    " 1.151688+1 3.071900-1 7.925129-3 8.594044-5 3.685993-6-4.402043-79228 6  2     \n"
    " 2.936000+2 0.000000+0          3         13         54         149228 6  2     \n"
    " 1.157786+6 1.157786+6 1.157786+6 1.157786+6 1.157786+6 1.157786+69228 6  2     \n"
    " 1.156223+6 1.154663+6 1.153105+6 1.151548+6 1.149994+6 1.148442+69228 6  2     \n"
    " 1.019964+6 8.985596+5 7.916170+5 6.974121+5 6.144265+5 5.413231+59228 6  2     \n"
    " 9.361881-2-2.894182-2-1.280872-3-5.491693-5-4.776453-7-6.347033-89228 6  2     \n"
    " 9.361240-2-2.893777-2-1.280570-3-5.489336-5-4.795861-7-5.750995-89228 6  2     \n"
    " 9.302893-2-2.857880-2-1.248561-3-5.215756-5-2.045084-6 9.231365-89228 6  2     \n"
    " 1.083607+1 6.794822-1 3.927473-2 8.903428-4 1.570001-5 6.466647-89228 6  2     \n"
    " 1.083607+1 6.794909-1 3.927639-2 8.904056-4 1.570449-5 5.870556-89228 6  2     \n"
    " 1.083570+1 6.802390-1 3.941654-2 8.951766-4 1.749113-5-9.116641-89228 6  2     \n"
    " 2.936000+2 0.000000+0          3         14         54         159228 6  2     \n"
    " 1.156371+6 1.156371+6 1.156371+6 1.156371+6 1.156371+6 1.156371+69228 6  2     \n"
    " 1.154994+6 1.153620+6 1.152247+6 1.150875+6 1.149506+6 1.148137+69228 6  2     \n"
    " 1.033272+6 9.232978+5 8.250471+5 7.372681+5 6.588428+5 5.887730+59228 6  2     \n"
    " 8.051205-2-2.176582-2-2.681534-3-2.481261-4-7.668127-6-2.769451-79228 6  2     \n"
    " 8.050460-2-2.176176-2-2.680728-3-2.481032-4-7.700046-6-2.607416-79228 6  2     \n"
    " 7.984561-2-2.140480-2-2.610354-3-2.459246-4-1.037464-5 1.091887-69228 6  2     \n"
    " 9.476945+0 1.383900+0 1.671169-1 1.065436-2 5.119531-4 5.809020-69228 6  2     \n"
    " 9.476930+0 1.383921+0 1.671264-1 1.065582-2 5.121009-4 5.794436-69228 6  2     \n"
    " 9.475068+0 1.385837+0 1.679658-1 1.078494-2 5.250972-4 4.585850-69228 6  2     \n"
    " 2.936000+2 0.000000+0          3         15         54         169228 6  2     \n"
    " 5.809202+5 5.809202+5 5.809202+5 5.809202+5 5.809202+5 5.809202+59228 6  2     \n"
    " 5.803194+5 5.797192+5 5.791196+5 5.785207+5 5.779224+5 5.773247+59228 6  2     \n"
    " 5.264252+5 4.770474+5 4.323057+5 3.917645+5 3.550291+5 3.217417+59228 6  2     \n"
    " 1.142748-1-2.120481-2-7.331743-3-1.741399-3-1.846860-4-1.361281-59228 6  2     \n"
    " 1.142680-1-2.120235-2-7.330404-3-1.740971-3-1.846271-4-1.360749-59228 6  2     \n"
    " 1.136612-1-2.098274-2-7.211105-3-1.702914-3-1.794050-4-1.313719-59228 6  2     \n"
    " 7.707332+0 1.978670+0 4.205811-1 5.677433-2 5.020447-3 8.367641-59228 6  2     \n"
    " 7.707324+0 1.978674+0 4.205872-1 5.677655-2 5.020797-3 8.367950-59228 6  2     \n"
    " 7.706629+0 1.979050+0 4.211349-1 5.697676-2 5.052387-3 8.396518-59228 6  2     \n"
    " 2.936000+2 0.000000+0          3         16         54         179228 6  2     \n"
    " 7.341455+5 7.341455+5 7.341455+5 7.341455+5 7.341455+5 7.341455+59228 6  2     \n"
    " 7.334852+5 7.328254+5 7.321662+5 7.315077+5 7.308497+5 7.301923+59228 6  2     \n"
    " 6.735186+5 6.179062+5 5.668930+5 5.200979+5 4.771717+5 4.377939+59228 6  2     \n"
    " 6.874269-2-8.557431-3-4.936369-3-1.985201-3-4.287056-4-5.722059-59228 6  2     \n"
    " 6.873782-2-8.556259-3-4.935305-3-1.984628-3-4.285489-4-5.719506-59228 6  2     \n"
    " 6.829804-2-8.450472-3-4.839539-3-1.933219-3-4.145221-4-5.491563-59228 6  2     \n"
    " 6.216635+0 2.176594+0 6.904881-1 1.737301-1 2.615526-2 6.870537-49228 6  2     \n"
    " 6.216623+0 2.176595+0 6.904962-1 1.737372-1 2.615722-2 6.871116-49228 6  2     \n"
    " 6.215515+0 2.176647+0 6.912328-1 1.743860-1 2.633538-2 6.924124-49228 6  2     \n"
    " 2.936000+2 0.000000+0          3         17         54         189228 6  2     \n"
    " 1.030736+6 1.030736+6 1.030736+6 1.030736+6 1.030736+6 1.030736+69228 6  2     \n"
    " 1.029938+6 1.029141+6 1.028344+6 1.027548+6 1.026752+6 1.025958+69228 6  2     \n"
    " 9.566351+5 8.878708+5 8.240580+5 7.648394+5 7.098838+5 6.588836+59228 6  2     \n"
    " 5.083672-2-3.202776-3-3.344441-3-1.644978-3-1.060212-3-3.063711-49228 6  2     \n"
    " 5.083350-2-3.202399-3-3.343797-3-1.644553-3-1.059872-3-3.062515-49228 6  2     \n"
    " 5.053869-2-3.168058-3-3.285155-3-1.605832-3-1.028943-3-2.954267-49228 6  2     \n"
    " 4.807983+0 2.113374+0 9.089023-1 4.298031-1 1.097681-1 6.113200-39228 6  2     \n"
    " 4.807973+0 2.113370+0 9.089066-1 4.298164-1 1.097749-1 6.113777-39228 6  2     \n"
    " 4.807043+0 2.113020+0 9.092919-1 4.310403-1 1.103889-1 6.167064-39228 6  2     \n"
    " 2.936000+2 0.000000+0          3         18         54         199228 6  2     \n"
    " 1.175655+6 1.175655+6 1.175655+6 1.175655+6 1.175655+6 1.175655+69228 6  2     \n"
    " 1.174846+6 1.174038+6 1.173230+6 1.172423+6 1.171616+6 1.170810+69228 6  2     \n"
    " 1.099930+6 1.029084+6 9.628026+5 9.007920+5 8.427768+5 7.884994+59228 6  2     \n"
    " 3.843781-2-8.171811-4-3.428805-3 1.421714-3-1.505400-3-1.294442-39228 6  2     \n"
    " 3.843661-2-8.171469-4-3.428484-3 1.421543-3-1.505164-3-1.294195-39228 6  2     \n"
    " 3.832519-2-8.139880-4-3.398841-3 1.405813-3-1.483414-3-1.271494-39228 6  2     \n"
    " 3.795489+0 1.928765+0 1.057004+0 8.235713-1 3.515114-1 4.950772-29228 6  2     \n"
    " 3.795488+0 1.928764+0 1.057006+0 8.235783-1 3.515181-1 4.950949-29228 6  2     \n"
    " 3.795340+0 1.928660+0 1.057183+0 8.242267-1 3.521281-1 4.967223-29228 6  2     \n"
    " 2.936000+2 0.000000+0          3         19         54         209228 6  2     \n"
    " 5.407961+5 5.407961+5 5.407961+5 5.407961+5 5.407961+5 5.407961+59228 6  2     \n"
    " 5.404269+5 5.400579+5 5.396891+5 5.393206+5 5.389523+5 5.385843+59228 6  2     \n"
    " 5.062082+5 4.738327+5 4.435280+5 4.151617+5 3.886097+5 3.637561+59228 6  2     \n"
    " 6.255888-2-3.011724-3-7.437133-3 8.139158-3 1.183596-3-6.067192-39228 6  2     \n"
    " 6.255940-2-3.011774-3-7.437319-3 8.139428-3 1.183645-3-6.067496-39228 6  2     \n"
    " 6.260772-2-3.016448-3-7.454561-3 8.164586-3 1.188217-3-6.095624-39228 6  2     \n"
    " 3.508950+0 1.979096+0 1.331184+0 1.150201+0 6.940925-1 1.856134-19228 6  2     \n"
    " 3.508949+0 1.979094+0 1.331183+0 1.150199+0 6.940894-1 1.856118-19228 6  2     \n"
    " 3.508890+0 1.979022+0 1.331022+0 1.150002+0 6.938036-1 1.854570-19228 6  2     \n"
    " 2.936000+2 0.000000+0          3         20         54         219228 6  2     \n"
    " 4.481702+5 4.481702+5 4.481702+5 4.481702+5 4.481702+5 4.481702+59228 6  2     \n"
    " 4.478473+5 4.475247+5 4.472023+5 4.468801+5 4.465582+5 4.462365+59228 6  2     \n"
    " 4.180346+5 3.899260+5 3.637080+5 3.392535+5 3.164437+5 2.951681+59228 6  2     \n"
    " 5.679545-2-3.874833-3-3.898629-3 5.337657-3 5.200577-3-6.354346-39228 6  2     \n"
    " 5.679671-2-3.874980-3-3.898884-3 5.338134-3 5.201148-3-6.355182-39228 6  2     \n"
    " 5.691254-2-3.888501-3-3.922492-3 5.382257-3 5.254011-3-6.432685-39228 6  2     \n"
    " 3.712065+0 2.335592+0 1.740161+0 1.409701+0 1.026658+0 4.140791-19228 6  2     \n"
    " 3.712063+0 2.335588+0 1.740156+0 1.409696+0 1.026650+0 4.140729-19228 6  2     \n"
    " 3.711825+0 2.335226+0 1.739615+0 1.409216+0 1.025909+0 4.134913-19228 6  2     \n"
    " 2.936000+2 0.000000+0          3         21         54         229228 6  2     \n"
    " 3.429532+5 3.429532+5 3.429532+5 3.429532+5 3.429532+5 3.429532+59228 6  2     \n"
    " 3.426903+5 3.424276+5 3.421651+5 3.419028+5 3.416407+5 3.413788+59228 6  2     \n"
    " 3.185175+5 2.958233+5 2.747463+5 2.551714+5 2.369915+5 2.201071+59228 6  2     \n"
    " 5.407417-2-1.538717-3 7.996709-4 5.352134-4 8.393649-3-4.504178-39228 6  2     \n"
    " 5.407528-2-1.538750-3 7.997193-4 5.352742-4 8.394502-3-4.504722-39228 6  2     \n"
    " 5.417754-2-1.541802-3 8.041820-4 5.408929-4 8.473290-3-4.554947-39228 6  2     \n"
    " 4.101085+0 2.923663+0 2.282064+0 1.757455+0 1.390455+0 7.471142-19228 6  2     \n"
    " 4.101082+0 2.923658+0 2.282057+0 1.757449+0 1.390448+0 7.471068-19228 6  2     \n"
    " 4.100843+0 2.923233+0 2.281483+0 1.756917+0 1.389773+0 7.464320-19228 6  2     \n"
    " 2.936000+2 0.000000+0          3         22         54         239228 6  2     \n"
    " 2.344895+5 2.344895+5 2.344895+5 2.344895+5 2.344895+5 2.344895+59228 6  2     \n"
    " 2.343027+5 2.341161+5 2.339296+5 2.337432+5 2.335570+5 2.333709+59228 6  2     \n"
    " 2.171752+5 2.011394+5 1.862877+5 1.725327+5 1.597933+5 1.479945+59228 6  2     \n"
    " 4.582327-2 3.672316-3 3.959561-3-1.538195-3 7.725156-3-1.004237-39228 6  2     \n"
    " 4.582366-2 3.672398-3 3.959660-3-1.538231-3 7.725472-3-1.004280-39228 6  2     \n"
    " 4.585867-2 3.679978-3 3.968772-3-1.541540-3 7.754495-3-1.008227-39228 6  2     \n"
    " 4.446361+0 3.494303+0 2.809391+0 2.174658+0 1.724813+0 1.098074+09228 6  2     \n"
    " 4.446360+0 3.494301+0 2.809388+0 2.174656+0 1.724811+0 1.098072+09228 6  2     \n"
    " 4.446302+0 3.494199+0 2.809238+0 2.174489+0 1.724627+0 1.097871+09228 6  2     \n"
    " 2.936000+2 0.000000+0          3         23         54         249228 6  2     \n"
    " 2.235493+5 2.235493+5 2.235493+5 2.235493+5 2.235493+5 2.235493+59228 6  2     \n"
    " 2.233756+5 2.232020+5 2.230285+5 2.228551+5 2.226819+5 2.225088+59228 6  2     \n"
    " 2.074169+5 1.924499+5 1.785639+5 1.656808+5 1.537282+5 1.426387+59228 6  2     \n"
    " 2.489880-2 4.687314-3 3.452907-3 2.758820-4 3.413405-3 9.217652-49228 6  2     \n"
    " 2.489821-2 4.687094-3 3.452665-3 2.758563-4 3.413007-3 9.216365-49228 6  2     \n"
    " 2.484490-2 4.667004-3 3.430470-3 2.734837-4 3.376419-3 9.097752-49228 6  2     \n"
    " 4.388294+0 3.692200+0 3.100508+0 2.521608+0 1.993993+0 1.427364+09228 6  2     \n"
    " 4.388288+0 3.692193+0 3.100504+0 2.521610+0 1.993998+0 1.427375+09228 6  2     \n"
    " 4.387864+0 3.691677+0 3.100181+0 2.521774+0 1.994400+0 1.428388+09228 6  2     \n"
    " 2.936000+2 0.000000+0          3         24         54         259228 6  2     \n"
    " 4.396217+4 4.396217+4 4.396217+4 4.396217+4 4.396217+4 4.396217+49228 6  2     \n"
    " 4.393265+4 4.390315+4 4.387367+4 4.384421+4 4.381477+4 4.378534+49228 6  2     \n"
    " 4.119424+4 3.860076+4 3.617073+4 3.389383+4 3.176040+4 2.976140+49228 6  2     \n"
    " 2.530223-2 5.539022-3 3.384702-3 3.564454-3 2.872137-3 2.076385-39228 6  2     \n"
    " 2.530136-2 5.538614-3 3.384337-3 3.563949-3 2.871626-3 2.075950-39228 6  2     \n"
    " 2.522051-2 5.500899-3 3.350623-3 3.517393-3 2.824621-3 2.035829-39228 6  2     \n"
    " 3.566572+0 3.067268+0 2.659995+0 2.301634+0 1.917227+0 1.503009+09228 6  2     \n"
    " 3.566568+0 3.067260+0 2.659985+0 2.301624+0 1.917219+0 1.503006+09228 6  2     \n"
    " 3.566228+0 3.066543+0 2.659054+0 2.300731+0 1.916574+0 1.502744+09228 6  2     \n"
    " 2.936000+2 0.000000+0          3         25         54         269228 6  2     \n"
    " 2.311834+4 2.311834+4 2.311834+4 2.311834+4 2.311834+4 2.311834+49228 6  2     \n"
    " 2.310431+4 2.309030+4 2.307629+4 2.306229+4 2.304830+4 2.303432+49228 6  2     \n"
    " 2.179531+4 2.054804+4 1.937218+4 1.826365+4 1.721859+4 1.623336+49228 6  2     \n"
    " 2.252061-2 3.986608-3 1.269266-3 2.200269-3 2.408146-3 1.502925-39228 6  2     \n"
    " 2.252009-2 3.986413-3 1.269173-3 2.200061-3 2.407861-3 1.502710-39228 6  2     \n"
    " 2.247113-2 3.968264-3 1.260476-3 2.180641-3 2.381384-3 1.482796-39228 6  2     \n"
    " 2.936496+0 2.504593+0 2.154183+0 1.886941+0 1.641360+0 1.377689+09228 6  2     \n"
    " 2.936495+0 2.504589+0 2.154177+0 1.886934+0 1.641354+0 1.377685+09228 6  2     \n"
    " 2.936323+0 2.504228+0 2.153643+0 1.886284+0 1.640756+0 1.377295+09228 6  2     \n"
    " 2.936000+2 0.000000+0          3         26         54         279228 6  2     \n"
    " 1.410474+4 1.410474+4 1.410474+4 1.410474+4 1.410474+4 1.410474+49228 6  2     \n"
    " 1.409665+4 1.408855+4 1.408046+4 1.407238+4 1.406430+4 1.405622+49228 6  2     \n"
    " 1.333844+4 1.261378+4 1.192849+4 1.128043+4 1.066758+4 1.008802+49228 6  2     \n"
    " 1.606367-2 3.826734-3 6.464258-4 8.473896-5 8.019005-4 7.075660-49228 6  2     \n"
    " 1.606352-2 3.826665-3 6.464079-4 8.473497-5 8.018661-4 7.075293-49228 6  2     \n"
    " 1.605093-2 3.820315-3 6.447346-4 8.436638-5 7.986822-4 7.041061-49228 6  2     \n"
    " 2.624682+0 2.267657+0 1.924789+0 1.655038+0 1.456340+0 1.277632+09228 6  2     \n"
    " 2.624680+0 2.267656+0 1.924789+0 1.655037+0 1.456339+0 1.277632+09228 6  2     \n"
    " 2.624684+0 2.267658+0 1.924785+0 1.655020+0 1.456319+0 1.277628+09228 6  2     \n"
    " 2.936000+2 0.000000+0          3         27         54         289228 6  2     \n"
    " 1.905167+4 1.905167+4 1.905167+4 1.905167+4 1.905167+4 1.905167+49228 6  2     \n"
    " 1.904072+4 1.902978+4 1.901884+4 1.900790+4 1.899698+4 1.898606+49228 6  2     \n"
    " 1.801546+4 1.703561+4 1.610906+4 1.523289+4 1.440439+4 1.362094+49228 6  2     \n"
    " 1.399307-2 4.776898-3 1.297866-3-1.743956-4 1.958350-4 1.483353-49228 6  2     \n"
    " 1.399313-2 4.776943-3 1.297886-3-1.743962-4 1.958390-4 1.483400-49228 6  2     \n"
    " 1.399869-2 4.781290-3 1.299779-3-1.744545-4 1.962142-4 1.487794-49228 6  2     \n"
    " 2.678872+0 2.379734+0 2.048817+0 1.760554+0 1.539864+0 1.357814+09228 6  2     \n"
    " 2.678872+0 2.379733+0 2.048817+0 1.760554+0 1.539864+0 1.357813+09228 6  2     \n"
    " 2.678862+0 2.379716+0 2.048793+0 1.760527+0 1.539835+0 1.357783+09228 6  2     \n"
    " 2.936000+2 0.000000+0          3         28         54         299228 6  2     \n"
    " 7.393520+4 7.393520+4 7.393520+4 7.393520+4 7.393520+4 7.393520+49228 6  2     \n"
    " 7.389224+4 7.384930+4 7.380639+4 7.376350+4 7.372064+4 7.367780+49228 6  2     \n"
    " 6.987269+4 6.603341+4 6.240508+4 5.897612+4 5.573558+4 5.267309+49228 6  2     \n"
    " 1.334697-2 4.946399-3 1.830180-3 1.359152-4 1.278761-4-9.123425-59228 6  2     \n"
    " 1.334702-2 4.946438-3 1.830201-3 1.359187-4 1.278783-4-9.123555-59228 6  2     \n"
    " 1.335148-2 4.950098-3 1.832218-3 1.362480-4 1.280828-4-9.135709-59228 6  2     \n"
    " 2.785750+0 2.519765+0 2.204480+0 1.911744+0 1.671759+0 1.472510+09228 6  2     \n"
    " 2.785750+0 2.519765+0 2.204479+0 1.911744+0 1.671758+0 1.472510+09228 6  2     \n"
    " 2.785741+0 2.519749+0 2.204458+0 1.911717+0 1.671728+0 1.472479+09228 6  2     \n"
    " 2.936000+2 0.000000+0          3         29         54         309228 6  2     \n"
    " 3.724277+3 3.724277+3 3.724277+3 3.724277+3 3.724277+3 3.724277+39228 6  2     \n"
    " 3.722046+3 3.719816+3 3.717587+3 3.715360+3 3.713134+3 3.710910+39228 6  2     \n"
    " 3.513648+3 3.314933+3 3.127457+3 2.950585+3 2.783716+3 2.626285+39228 6  2     \n"
    " 3.329607-2 1.633187-2 7.624305-3 2.763879-3 1.034109-3 2.778717-59228 6  2     \n"
    " 3.329635-2 1.633216-2 7.624512-3 2.763981-3 1.034156-3 2.779188-59228 6  2     \n"
    " 3.332280-2 1.635941-2 7.643755-3 2.773554-3 1.038549-3 2.823327-59228 6  2     \n"
    " 2.936360+0 2.720475+0 2.441470+0 2.159607+0 1.902717+0 1.677021+09228 6  2     \n"
    " 2.936359+0 2.720474+0 2.441468+0 2.159605+0 1.902715+0 1.677019+09228 6  2     \n"
    " 2.936304+0 2.720377+0 2.441327+0 2.159421+0 1.902500+0 1.676786+09228 6  2     \n";
}

std::string validSEND() {
    return
    "                                                                  9228 6  0     \n";
}

void verifyChunk(const section::GType< 6 >& chunk) {
    CHECK(92235 == chunk.ZA());
    CHECK(92235 == chunk.targetIdentifier());
    CHECK(2 == chunk.MT());
    CHECK(2 == chunk.sectionNumber());
    CHECK(6 == chunk.NL());
    CHECK(6 == chunk.numberMoments());
    CHECK(3 == chunk.NZ());
    CHECK(3 == chunk.numberDilutions());
    CHECK(30 == chunk.NGN());
    CHECK(30 == chunk.numberNeutronGroups());
    CHECK(0 == chunk.LRFLAG());
    CHECK(0 == chunk.breakUpID());
    CHECK_THAT( 293.6, WithinRel( chunk.TEMP() ) );
    CHECK_THAT( 293.6, WithinRel( chunk.temperature() ) );
    std::vector< unsigned int > expected_groups(30);
    std::iota(expected_groups.begin(), expected_groups.end(), 1);
    for ( size_t g = 0; g < chunk.NGN(); ++g) {
        CHECK( expected_groups[g] == chunk.groups()[g] );
    }


}