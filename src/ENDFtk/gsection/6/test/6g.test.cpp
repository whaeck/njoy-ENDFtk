// include Catch2
#include <catch2/catch_test_macros.hpp>
#include <catch2/matchers/catch_matchers_floating_point.hpp>
using Catch::Matchers::WithinRel;

// what is being tested
#include "ENDFtk/gsection/6g.hpp"

// other includes
#include "ENDFtk/tree/Section.hpp"
#include "tools/std20/algorithm.hpp"

// aliasing
using namespace njoy::ENDFtk;

std::string chunk();
std::string validSEND();
// Note: MF6 MT18, the prob here are definitely chi

void verifyChunk( const section::GType< 6 >& );

SCENARIO("section::GType<6>") {

    GIVEN("valid data for a section::GType<3> with matrix values") {
        std::string sectionString = chunk() + validSEND();

        WHEN("the data is read from a string") {

            std::string line = chunk() + validSEND();
            auto begin = line.begin();
            auto end = line.end();
            long lineNumber = 0;
            auto head = HeadRecord(begin, end, lineNumber);

            section::GType< 6 > chunk(head, begin, end, lineNumber, 9228 );


            THEN("a section GType< 6 > can be constructed and its"
                " members can be tested") {
                verifyChunk(chunk);
            } // THEN

            THEN("it can be printed") {
                std::string buffer;
                auto output = std::back_inserter( buffer );
                chunk.print( output, 9228, 6 );

                CHECK( buffer == sectionString );
            } // THEN

        } // WHEN

    } // GIVEN

} // SCENARIO

std::string chunk() {
    return
   " 9.223500+4 0.000000+0          2          3          0         309228 6  2     \n"
   " 2.936000+2 0.000000+0          2          1         12          19228 6  2     \n"
   " 1.270791+7 1.270790+7 1.197023+7 1.128546+7 2.016090+6 3.552522+59228 6  2     \n"
   " 1.402599+1 4.116491-2 1.402211+1 4.114286-2 1.398153+1 4.092680-29228 6  2     \n"
   " 2.936000+2 0.000000+0          3          1         18          29228 6  2     \n"
   " 1.149905+6 1.149905+6 1.124479+6 1.099624+6 3.559089+5 1.113871+59228 6  2     \n"
   " 1.159120-1-3.840804-2 1.156551-1-3.824018-2 1.073600-1-3.264860-29228 6  2     \n"
   " 1.338970+1 7.804564-2 1.338993+1 7.787764-2 1.339702+1 7.227781-29228 6  2     \n"
   " 2.936000+2 0.000000+0          3          2         18          39228 6  2     \n"
   " 1.158584+6 1.158584+6 1.147463+6 1.136454+6 5.945259+5 3.080750+59228 6  2     \n"
   " 1.144792-1-3.792949-2 1.139788-1-3.760349-2 9.247718-2-2.464956-29228 6  2     \n"
   " 1.287530+1 7.605390-2 1.287562+1 7.572682-2 1.288761+1 6.271752-29228 6  2     \n"
   " 2.936000+2 0.000000+0          3          3         18          49228 6  2     \n"
   " 1.148732+6 1.148732+6 1.143887+6 1.139071+6 8.277563+5 6.075435+59228 6  2     \n"
   " 1.097813-1-3.643020-2 1.085738-1-3.563909-2 5.997193-2-1.074848-29228 6  2     \n"
   " 1.212760+1 7.234868-2 1.212823+1 7.155418-2 1.214616+1 4.650515-29228 6  2     \n"
   " 2.936000+2 0.000000+0          3          4         18          59228 6  2     \n"
   " 1.155337+6 1.155337+6 1.149144+6 1.143039+6 8.242293+5 6.180888+59228 6  2     \n"
   " 9.740076-2-3.228766-2 9.732506-2-3.221320-2 8.450808-2-2.215762-29228 6  2     \n"
   " 1.091143+1 6.460569-2 1.090985+1 6.452165-2 1.087842+1 5.427686-29228 6  2     \n"
   " 2.936000+2 0.000000+0          3          5         18          69228 6  2     \n"
   " 1.154847+6 1.154847+6 1.141705+6 1.129072+6 6.987721+5 4.707030+59228 6  2     \n"
   " 7.255709-2-2.366750-2 7.307452-2-2.397713-2 8.372864-2-2.667735-29228 6  2     \n"
   " 1.174589+1 5.837896-2 1.169065+1 5.837743-2 1.095368+1 5.844992-29228 6  2     \n"
   " 2.936000+2 0.000000+0          3          6         18          79228 6  2     \n"
   " 1.153966+6 1.153966+6 1.144432+6 1.135065+6 7.170965+5 4.826207+59228 6  2     \n"
   " 7.881345-2-2.588198-2 7.906602-2-2.589373-2 8.917295-2-2.370854-29228 6  2     \n"
   " 1.141527+1 5.968446-2 1.139907+1 5.960380-2 1.098360+1 5.563976-29228 6  2     \n"
   " 2.936000+2 0.000000+0          3          7         18          89228 6  2     \n"
   " 1.154819+6 1.154819+6 1.149445+6 1.144111+6 8.250987+5 6.107359+59228 6  2     \n"
   " 1.023005-1-3.338013-2 1.025090-1-3.352426-2 1.133754-1-4.036831-29228 6  2     \n"
   " 1.117259+1 6.702109-2 1.116635+1 6.712941-2 1.090725+1 7.277767-29228 6  2     \n"
   " 2.936000+2 0.000000+0          3          8         18          99228 6  2     \n"
   " 1.153684+6 1.153684+6 1.149437+6 1.145215+6 8.671104+5 6.661531+59228 6  2     \n"
   " 9.123374-2-3.125920-2 9.118939-2-3.120287-2 8.678913-2-2.616666-29228 6  2     \n"
   " 1.155974+1 6.846274-2 1.155405+1 6.837159-2 1.129104+1 6.199191-29228 6  2     \n"
   " 2.936000+2 0.000000+0          3          9         18         109228 6  2     \n"
   " 1.154784+6 1.154784+6 1.151641+6 1.148509+6 9.151104+5 7.306688+59228 6  2     \n"
   " 9.157943-2-2.847210-2 9.162437-2-2.850141-2 9.485349-2-3.057042-29228 6  2     \n"
   " 1.182669+1 7.367775-2 1.182468+1 7.369417-2 1.170173+1 7.505725-29228 6  2     \n"
   " 2.936000+2 0.000000+0          3         10         18         119228 6  2     \n"
   " 1.152800+6 1.152800+6 1.150432+6 1.148069+6 9.572601+5 7.958322+59228 6  2     \n"
   " 1.051344-1-3.419557-2 1.051085-1-3.418560-2 1.030043-1-3.334270-29228 6  2     \n"
   " 1.221638+1 1.015693-1 1.221597+1 1.015572-1 1.218568+1 1.005473-19228 6  2     \n"
   " 2.936000+2 0.000000+0          3         11         18         129228 6  2     \n"
   " 1.156920+6 1.156920+6 1.154913+6 1.152910+6 9.854300+5 8.391668+59228 6  2     \n"
   " 1.038892-1-3.413673-2 1.038839-1-3.413276-2 1.034428-1-3.380721-29228 6  2     \n"
   " 1.196275+1 1.575021-1 1.196277+1 1.575028-1 1.196173+1 1.575510-19228 6  2     \n"
   " 2.936000+2 0.000000+0          3         12         18         139228 6  2     \n"
   " 1.154341+6 1.154341+6 1.152599+6 1.150859+6 1.002600+6 8.706505+59228 6  2     \n"
   " 1.003733-1-3.246933-2 1.003600-1-3.246081-2 9.918750-2-3.172007-29228 6  2     \n"
   " 1.151432+1 3.072534-1 1.151439+1 3.072537-1 1.151688+1 3.071900-19228 6  2     \n"
   " 2.936000+2 0.000000+0          3         13         18         149228 6  2     \n"
   " 1.157786+6 1.157786+6 1.156223+6 1.154663+6 1.019964+6 8.985596+59228 6  2     \n"
   " 9.361881-2-2.894182-2 9.361240-2-2.893777-2 9.302893-2-2.857880-29228 6  2     \n"
   " 1.083607+1 6.794822-1 1.083607+1 6.794909-1 1.083570+1 6.802390-19228 6  2     \n"
   " 2.936000+2 0.000000+0          3         14         18         159228 6  2     \n"
   " 1.156371+6 1.156371+6 1.154994+6 1.153620+6 1.033272+6 9.232978+59228 6  2     \n"
   " 8.051205-2-2.176583-2 8.050461-2-2.176176-2 7.984561-2-2.140480-29228 6  2     \n"
   " 9.476945+0 1.383900+0 9.476930+0 1.383921+0 9.475068+0 1.385837+09228 6  2     \n"
   " 2.936000+2 0.000000+0          3         15         18         169228 6  2     \n"
   " 5.809202+5 5.809202+5 5.803194+5 5.797192+5 5.264252+5 4.770474+59228 6  2     \n"
   " 1.142748-1-2.120481-2 1.142680-1-2.120235-2 1.136612-1-2.098274-29228 6  2     \n"
   " 7.707332+0 1.978670+0 7.707324+0 1.978674+0 7.706629+0 1.979050+09228 6  2     \n"
   " 2.936000+2 0.000000+0          3         16         18         179228 6  2     \n"
   " 7.341455+5 7.341455+5 7.334852+5 7.328254+5 6.735186+5 6.179062+59228 6  2     \n"
   " 6.874269-2-8.557432-3 6.873783-2-8.556260-3 6.829804-2-8.450473-39228 6  2     \n"
   " 6.216635+0 2.176594+0 6.216623+0 2.176595+0 6.215515+0 2.176647+09228 6  2     \n"
   " 2.936000+2 0.000000+0          3         17         18         189228 6  2     \n"
   " 1.030736+6 1.030736+6 1.029938+6 1.029141+6 9.566351+5 8.878708+59228 6  2     \n"
   " 5.083672-2-3.202776-3 5.083350-2-3.202399-3 5.053869-2-3.168058-39228 6  2     \n"
   " 4.807983+0 2.113374+0 4.807973+0 2.113370+0 4.807043+0 2.113020+09228 6  2     \n"
   " 2.936000+2 0.000000+0          3         18         18         199228 6  2     \n"
   " 1.175655+6 1.175655+6 1.174846+6 1.174038+6 1.099930+6 1.029084+69228 6  2     \n"
   " 3.843781-2-8.171811-4 3.843661-2-8.171469-4 3.832519-2-8.139880-49228 6  2     \n"
   " 3.795489+0 1.928765+0 3.795488+0 1.928764+0 3.795340+0 1.928660+09228 6  2     \n"
   " 2.936000+2 0.000000+0          3         19         18         209228 6  2     \n"
   " 5.407961+5 5.407961+5 5.404269+5 5.400579+5 5.062082+5 4.738327+59228 6  2     \n"
   " 6.255888-2-3.011724-3 6.255940-2-3.011774-3 6.260772-2-3.016448-39228 6  2     \n"
   " 3.508950+0 1.979096+0 3.508949+0 1.979094+0 3.508890+0 1.979022+09228 6  2     \n"
   " 2.936000+2 0.000000+0          3         20         18         219228 6  2     \n"
   " 4.481702+5 4.481702+5 4.478473+5 4.475247+5 4.180346+5 3.899260+59228 6  2     \n"
   " 5.679545-2-3.874833-3 5.679671-2-3.874980-3 5.691254-2-3.888501-39228 6  2     \n"
   " 3.712065+0 2.335592+0 3.712063+0 2.335588+0 3.711825+0 2.335226+09228 6  2     \n"
   " 2.936000+2 0.000000+0          3         21         18         229228 6  2     \n"
   " 3.429532+5 3.429532+5 3.426903+5 3.424276+5 3.185175+5 2.958233+59228 6  2     \n"
   " 5.407417-2-1.538717-3 5.407528-2-1.538750-3 5.417754-2-1.541802-39228 6  2     \n"
   " 4.101085+0 2.923663+0 4.101082+0 2.923658+0 4.100843+0 2.923233+09228 6  2     \n"
   " 2.936000+2 0.000000+0          3         22         18         239228 6  2     \n"
   " 2.344895+5 2.344895+5 2.343027+5 2.341161+5 2.171752+5 2.011394+59228 6  2     \n"
   " 4.582327-2 3.672316-3 4.582365-2 3.672398-3 4.585867-2 3.679978-39228 6  2     \n"
   " 4.446361+0 3.494303+0 4.446360+0 3.494301+0 4.446302+0 3.494199+09228 6  2     \n"
   " 2.936000+2 0.000000+0          3         23         18         249228 6  2     \n"
   " 2.235493+5 2.235493+5 2.233756+5 2.232020+5 2.074169+5 1.924499+59228 6  2     \n"
   " 2.489880-2 4.687316-3 2.489821-2 4.687096-3 2.484490-2 4.667006-39228 6  2     \n"
   " 4.388294+0 3.692200+0 4.388288+0 3.692193+0 4.387864+0 3.691677+09228 6  2     \n"
   " 2.936000+2 0.000000+0          3         24         18         259228 6  2     \n"
   " 4.396217+4 4.396217+4 4.393265+4 4.390315+4 4.119424+4 3.860076+49228 6  2     \n"
   " 2.530222-2 5.539048-3 2.530134-2 5.538640-3 2.522050-2 5.500925-39228 6  2     \n"
   " 3.566572+0 3.067268+0 3.566568+0 3.067261+0 3.566228+0 3.066543+09228 6  2     \n"
   " 2.936000+2 0.000000+0          3         25         18         269228 6  2     \n"
   " 2.311834+4 2.311834+4 2.310431+4 2.309030+4 2.179531+4 2.054804+49228 6  2     \n"
   " 2.252058-2 3.986654-3 2.252006-2 3.986459-3 2.247110-2 3.968310-39228 6  2     \n"
   " 2.936496+0 2.504593+0 2.936495+0 2.504589+0 2.936323+0 2.504228+09228 6  2     \n"
   " 2.936000+2 0.000000+0          3         26         18         279228 6  2     \n"
   " 1.410474+4 1.410474+4 1.409665+4 1.408855+4 1.333844+4 1.261378+49228 6  2     \n"
   " 1.606364-2 3.826764-3 1.606350-2 3.826695-3 1.605091-2 3.820345-39228 6  2     \n"
   " 2.624682+0 2.267657+0 2.624680+0 2.267656+0 2.624684+0 2.267658+09228 6  2     \n"
   " 2.936000+2 0.000000+0          3         27         18         289228 6  2     \n"
   " 1.905167+4 1.905167+4 1.904072+4 1.902978+4 1.801546+4 1.703561+49228 6  2     \n"
   " 1.399303-2 4.776928-3 1.399308-2 4.776973-3 1.399864-2 4.781320-39228 6  2     \n"
   " 2.678757+0 2.379581+0 2.678756+0 2.379580+0 2.678746+0 2.379564+09228 6  2     \n"
   " 2.936000+2 0.000000+0          3         28         18         299228 6  2     \n"
   " 7.393520+4 7.393520+4 7.389224+4 7.384930+4 6.987269+4 6.603341+49228 6  2     \n"
   " 1.334681-2 4.946534-3 1.334686-2 4.946573-3 1.335131-2 4.950233-39228 6  2     \n"
   " 2.785690+0 2.519688+0 2.785690+0 2.519688+0 2.785681+0 2.519673+09228 6  2     \n"
   " 2.936000+2 0.000000+0          3         29         18         309228 6  2     \n"
   " 3.724277+3 3.724277+3 3.722046+3 3.719816+3 3.513648+3 3.314933+39228 6  2     \n"
   " 3.329641-2 1.633151-2 3.329669-2 1.633180-2 3.332314-2 1.635906-29228 6  2     \n"
   " 2.936360+0 2.720475+0 2.936359+0 2.720474+0 2.936304+0 2.720377+09228 6  2     \n";
}

std::string validSEND() {
    return
    "                                                                  9228 6  0     \n";
}

void verifyChunk(const section::GType< 6 >& chunk) {
    CHECK(92235 == chunk.ZA());
    CHECK(92235 == chunk.targetIdentifier());
    CHECK(2 == chunk.MT());
    CHECK(2 == chunk.sectionNumber());
    CHECK(2 == chunk.NL());
    CHECK(2 == chunk.numberMoments());
    CHECK(3 == chunk.NZ());
    CHECK(3 == chunk.numberDilutions());
    CHECK(30 == chunk.NGN());
    CHECK(30 == chunk.numberNeutronGroups());
    CHECK(0 == chunk.LRFLAG());
    CHECK(0 == chunk.breakUpID());
    CHECK_THAT( 293.6, WithinRel( chunk.TEMP() ) );
    CHECK_THAT( 293.6, WithinRel( chunk.temperature() ) );
    std::vector< unsigned int > expected_groups(30);
    std::iota(expected_groups.begin(), expected_groups.end(), 1);
    for ( size_t g = 0; g < chunk.NGN(); ++g) {
        CHECK( expected_groups[g] == chunk.groups()[g] );
    }
    std::vector< double > sig_0_0_1 = { 1.402599e1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_2 = { 1.159120e-1, 1.338970e1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_3 = { 0.0, 1.144792e-1, 1.287530e1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_4 = { 0.0, 0.0, 1.097813e-1, 1.212760e1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_5 = { 0.0, 0.0, 0.0, 9.740076e-2, 1.091143e1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_6 = { 0.0, 0.0, 0.0, 0.0, 7.255709e-2, 1.174589e1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_7 = { 0.0, 0.0, 0.0, 0.0, 0.0, 7.881345e-2, 1.141527e1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_8 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.023005e-1, 1.117259e1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_9 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.123374e-2, 1.155974e1, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_10 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.157943e-2, 1.182669e1, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_11 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.051344e-1, 1.221638e1, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_12 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.038892e-1, 1.196275e1, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_13 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.003733e-1, 1.151432e1, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_14 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.361881e-2, 1.083607e1,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_15 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.051205e-2,
        9.476945, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_16 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
        1.142748e-1, 7.707332, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_17 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
        0.0, 6.874269e-2, 6.216635, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_18 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
        0.0, 0.0, 5.083672e-2, 4.807983, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_19 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
        0.0, 0.0, 0.0, 3.843781e-2, 3.795489, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_20 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
        0.0, 0.0, 0.0, 0.0, 6.255888e-2, 3.508950, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_21 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
        0.0, 0.0, 0.0, 0.0, 0.0, 5.679545e-2, 3.712065, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_22 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.407417e-2, 4.101085, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_23 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.582327e-2, 4.446361, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_24 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.489880e-2, 4.388294, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_25 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.530222e-2, 3.566572, 0.0, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_26 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.252058e-2, 2.936496, 0.0, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_27 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.606364e-2, 2.624682, 0.0, 0.0, 0.0 };
    std::vector< double > sig_0_0_28 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.399303e-2, 2.678757, 0.0, 0.0 };
    std::vector< double > sig_0_0_29 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.334681e-2, 2.785690, 0.0 };
    std::vector< double > sig_0_0_30 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.329641e-2, 2.936360 };
    std::vector< std::vector< double > > sig_0_0;
    sig_0_0.push_back(sig_0_0_1);
    sig_0_0.push_back(sig_0_0_2);
    sig_0_0.push_back(sig_0_0_3);
    sig_0_0.push_back(sig_0_0_4);
    sig_0_0.push_back(sig_0_0_5);
    sig_0_0.push_back(sig_0_0_6);
    sig_0_0.push_back(sig_0_0_7);
    sig_0_0.push_back(sig_0_0_8);
    sig_0_0.push_back(sig_0_0_9);
    sig_0_0.push_back(sig_0_0_10);
    sig_0_0.push_back(sig_0_0_11);
    sig_0_0.push_back(sig_0_0_12);
    sig_0_0.push_back(sig_0_0_13);
    sig_0_0.push_back(sig_0_0_14);
    sig_0_0.push_back(sig_0_0_15);
    sig_0_0.push_back(sig_0_0_16);
    sig_0_0.push_back(sig_0_0_17);
    sig_0_0.push_back(sig_0_0_18);
    sig_0_0.push_back(sig_0_0_19);
    sig_0_0.push_back(sig_0_0_20);
    sig_0_0.push_back(sig_0_0_21);
    sig_0_0.push_back(sig_0_0_22);
    sig_0_0.push_back(sig_0_0_23);
    sig_0_0.push_back(sig_0_0_24);
    sig_0_0.push_back(sig_0_0_25);
    sig_0_0.push_back(sig_0_0_26);
    sig_0_0.push_back(sig_0_0_27);
    sig_0_0.push_back(sig_0_0_28);
    sig_0_0.push_back(sig_0_0_29);
    sig_0_0.push_back(sig_0_0_30);
    auto matrix = chunk.matrix(0, 0);
    for ( size_t g_i = 0; g_i < 30; ++g_i ) {
        for ( size_t g_o = 0; g_o < 30; ++g_o ) {
            CHECK_THAT(sig_0_0[g_i][g_o], WithinRel(matrix[g_i][g_o]));
        }
    }

    



}